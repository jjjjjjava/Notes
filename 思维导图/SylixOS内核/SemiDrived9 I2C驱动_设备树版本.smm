{"layout":"timeline","root":{"data":{"text":"<p><strong style=\"font-size: 24px; color: rgb(255, 255, 255); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;\">开始</strong></p>","richText":true,"expand":true,"isActive":false,"uid":"5de52bd8-1246-4795-b36e-0cc6e0a5e883"},"children":[{"data":{"text":"<p><span style=\"font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">概念理解</span></p>","expand":true,"richText":true,"isActive":false,"uid":"e4b30fb5-55e1-4df2-8f92-eb1da0f597b7","note":""},"children":[{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">什么是驱动？如何理解总线驱动和设备驱动？</span></p>","uid":"f54db12c-138c-43f6-a4a0-93988d4c8750","expand":true,"richText":true,"isActive":false,"note":"什么是驱动？如何理解驱动？驱动是不是一种操作设备的语言？就像不同动物有不同的语言一样，内核借助不同的驱动可以和不同的设备对话。\n\n所以内核控制挂载在i2c总线上的rtc设备时，实际上是先通过i2c设备驱动和i2c设备对话，然后再i2c上发送数据给rtc，在通过rtc驱动和rtc进行对话，对其进行操作和控制"},"children":[]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">什么是时钟源？</span></p>","expand":true,"richText":true,"isActive":false,"uid":"133ba167-fea0-43dc-a790-18a15ed39fbb","note":"时钟源是节拍器，同步两边的节拍，让两边能保持行动的一直。"},"children":[]}]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;\">bspInit中halBusInit</span></p>","generalization":null,"richText":true,"expand":true,"isActive":false,"uid":"7b78b71f-39cb-4bbb-b445-4e704cacd30f"},"children":[{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">API_I2cBusInit</span></p>","richText":true,"expand":true,"isActive":false,"uid":"975a9031-fe5a-4745-b86b-3a38ba0c91b0","note":"调用API_BusInit(&_G_bustypeI2c)\n\n实际就是对I2c总线实体结构体lw_bus_type中的操作锁，设备链表锁，   驱动链表锁，设备链表和驱动链表进行初始化操作"},"children":[]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">i2cBusDriverInstall</span></p>","richText":true,"expand":true,"isActive":false,"uid":"b5d7e3f9-3afa-4ed1-932a-c94411e6104e","associativeLineTargets":["6300933c-5589-431c-82e0-375b5744c217"],"associativeLineTargetControlOffsets":[[{"x":52,"y":0},{"x":-52,"y":0}]],"associativeLinePoint":[{"startPoint":{"x":1522,"y":493},"endPoint":{"x":1626,"y":400.5}}]},"children":[]}]},{"data":{"text":"<p><span style=\"font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">i2cBusDriveInstall</span></p>","expand":true,"richText":true,"isActive":false,"uid":"6300933c-5589-431c-82e0-375b5744c217","note":"初始化总线的驱动实体结构体"},"children":[{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">API_PlatformDriverRegister注册i2c总线驱动到内部平台</span></p>","uid":"2d7c00d6-17a9-48ef-909f-3607a527fa69","expand":true,"richText":true,"isActive":false,"note":"API_PlatformDriverRegister(&_G_Driver)\n\n\nstatic LW_DEVTREE_TABLE  _G_Match[] = {\n    {\n        .DTITEM_cCompatible = \"snps,designware-i2c\",\n    },\n    LW_DEVTREE_TABLE_END\n};\nstatic LW_DRV_INSTANCE  _G_Driver = {\n    .DRVHD_pcName      = \"i2c\",\n    .DRVHD_pMatchTable = _G_Match,\n    //检测到设备存在后的回调函数\n    .DRVHD_pfuncProbe  = __i2cBusProbe,\n};"},"children":[{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">设置驱动使用的总线</span></p>","uid":"75d50346-38e7-4956-bf45-641ac21aa378","expand":true,"richText":true,"isActive":false,"note":"pdrvinstance->DRVHD_pbustype = &_G_bustypePlatform;"},"children":[]},{"data":{"text":"<p><span style=\"font-size: 14px; color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;\">API_DriverRegister注册i2c驱动</span></p>","expand":true,"richText":true,"isActive":false,"uid":"65873f7a-965d-4d43-b440-0596c2e51773"},"children":[{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">参数检查</span></p>","uid":"2913632c-3e5f-41bd-ab87-16dc60ca364c","expand":true,"richText":true,"isActive":false,"note":"对驱动实体是否存在，驱动实体有要注册的总线是否存在，该总线是否初始化，驱动是否初始化名字进行参数检查"},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">__drvFind查找驱动是否已经注册</span></p>","uid":"115d2903-ef96-4b5b-a4cd-07d1f63a75a2","expand":true,"richText":true,"isActive":false},"children":[]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">__busAddDriver注册驱动</span></p>","expand":true,"richText":true,"isActive":false,"uid":"8a42eede-5628-41b5-b6c6-1f813ea15bf3"},"children":[{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">驱动添加到总线的驱动链表中</span></p>","uid":"4a5c500f-d4c2-4382-b50a-3b7ab3d3a6b4","expand":true,"richText":true,"isActive":false},"children":[]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">遍历总线上的设备，调用总线匹配函数，检测设备和驱动是否匹配</span></p>","expand":true,"richText":true,"isActive":false,"uid":"e336623b-ff98-4ca8-81a3-3bd10c59c0dd"},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">如果匹配，__drvAttach进行设备和驱动的绑定</span></p>","expand":true,"richText":true,"isActive":false,"uid":"8a63ac40-99c6-46df-9289-9250b29bfbc2","associativeLineTargets":["4447300e-a1ff-4a77-a258-ade79cc0f652"],"associativeLineTargetControlOffsets":[[{"x":110.5,"y":0},{"x":-110.5,"y":0}]],"associativeLinePoint":[{"startPoint":{"x":2461.5,"y":798},"endPoint":{"x":2682.5,"y":400.5}}]},"children":[]}]}]}]}]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;\">__drvAttach</span></p>","expand":true,"richText":true,"isActive":false,"uid":"4447300e-a1ff-4a77-a258-ade79cc0f652"},"children":[{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">绑定设备和驱动</span></p>","uid":"c5c1e954-c6f9-412b-8af3-0f6971f91d1f","expand":true,"richText":true,"isActive":false},"children":[]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">进行设备引脚的绑定</span></p>","uid":"bcd1928f-3ad8-40f2-8d49-913a6c43db97","expand":true,"richText":true,"isActive":false},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">平台的probe函数存在则调用</span></p>","expand":true,"richText":true,"isActive":false,"uid":"a2d74546-7e42-41e6-b73e-84df200df22d","note":"pdevinstance->DEVHD_pbustype->BUS_pfuncProbe(pdevinstance)"},"children":[]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">驱动的probe函数存在则调用</span></p>","expand":true,"richText":true,"isActive":false,"uid":"1e3bf17e-72e9-494e-9302-37d3f03c9814","note":"pdrvinstance->DRVHD_pfuncProbe(pdevinstance)","associativeLineTargets":["0c79b710-8ad3-4eb7-adba-b7647731cbc5"],"associativeLineTargetControlOffsets":[[{"x":52,"y":0},{"x":-52,"y":0}]],"associativeLinePoint":[{"startPoint":{"x":2980.5,"y":563},"endPoint":{"x":3084.5,"y":400.5}}]},"children":[]}]},{"data":{"text":"<p><span style=\"font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">__i2cBusProbe</span></p>","expand":true,"richText":true,"isActive":false,"uid":"0c79b710-8ad3-4eb7-adba-b7647731cbc5","note":"调用总线驱动的probe函数注册设备，这个设备是i2c总线设备，如i2c1,i2c2等。"},"children":[]}]},"theme":{"template":"avocado","config":{}},"view":{"transform":{"scaleX":1,"scaleY":1,"shear":0,"rotate":0,"translateX":-1472.750000000001,"translateY":-275.0000000000002,"originX":0,"originY":0,"a":1,"b":0,"c":0,"d":1,"e":-1472.750000000001,"f":-275.0000000000002},"state":{"scale":1,"x":-1472.750000000001,"y":-275.0000000000002,"sx":-1472.750000000001,"sy":-275.0000000000002}}}