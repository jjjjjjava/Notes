{"layout":"timeline","root":{"data":{"text":"<p><strong>开始</strong></p>","richText":true,"expand":true,"isActive":false,"uid":"0714e90d-8a49-45a1-91b8-44ee4d2ed92d"},"children":[{"data":{"text":"<p><span style=\"\n      color: #749336;\n      font-family: 微软雅黑, Microsoft YaHei;\n      font-size: 18px;\n      font-weight: noraml;\n      font-style: normal;\n      text-decoration: none\n    \">startup.s</span></p>","generalization":null,"richText":true,"expand":true,"isActive":false,"uid":"3ab85fcf-a841-4bc0-8a71-dae3be9e4bbd"},"children":[{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">开始</span></p>","uid":"3c638258-6ff9-415d-80df-e96af89b34f8","expand":true,"richText":true,"isActive":false},"children":[]},{"data":{"text":"<p><span style=\"\n      color: #749336;\n      font-family: 微软雅黑, Microsoft YaHei;\n      font-size: 14px;\n      font-weight: noraml;\n      font-style: normal;\n      text-decoration: none\n    \">配置处理器模式堆栈空间大小</span></p>","richText":true,"expand":true,"isActive":false,"uid":"01d7d5c5-d03b-4cf5-b904-abe4068aa5f8"},"children":[]},{"data":{"text":"<p><span style=\"\n      color: #749336;\n      font-family: 微软雅黑, Microsoft YaHei;\n      font-size: 14px;\n      font-weight: noraml;\n      font-style: normal;\n      text-decoration: none\n    \">声明外部函数，导出内部全局函数</span></p>","richText":true,"expand":true,"isActive":false,"uid":"b145e9a0-eac6-49f0-99fb-50d191abc814"},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">配置异常向量表，向量表起始位置执行复位操作</span></p>","uid":"f97ca5ba-d1ed-4dd1-8ac1-2a64ed0d1a9f","expand":true,"richText":true,"isActive":false},"children":[{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">复位开始</span></p>","uid":"737ae384-cff1-46f4-9953-64386565f006","expand":true,"richText":true,"isActive":false},"children":[]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">进入svc32_MODE+关中断</span></p>","expand":true,"richText":true,"isActive":false,"uid":"6d4f9878-4b3b-4be5-b6a4-6785b16d2f90"},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">初始化堆栈</span></p>","expand":true,"richText":true,"isActive":false,"uid":"38fca092-4ba8-424c-bd3d-5460e9ff9373"},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">错误修正</span></p>","expand":true,"richText":true,"isActive":false,"uid":"ba862c4b-1333-41fc-9c7a-8ce7987d310d"},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">cpu复位操作</span></p>","expand":true,"richText":true,"isActive":false,"uid":"90f9231e-7d3b-43da-bf95-a05bc691cb9f"},"children":[{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">开始</span></p>","uid":"bef85fc4-301e-450c-87ba-4da3709fa124","expand":true,"richText":true,"isActive":false},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">判断CPU id（后续根据cpu id进行主从cpu初始化）</span></p>","expand":true,"richText":true,"isActive":false,"uid":"5528ee3c-7717-4357-87fe-687a46f9e573"},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">关Cache,MMU</span></p>","expand":true,"richText":true,"isActive":false,"uid":"8128d2d4-c151-4e44-8c3b-327c4899407a"},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">初始化Data段</span></p>","expand":true,"richText":true,"isActive":false,"uid":"6cfcc66a-1feb-471f-8bf0-4643e2efbd66"},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">清零BSS段</span></p>","expand":true,"richText":true,"isActive":false,"uid":"8bb75513-6780-4a09-9fd7-624997dedd14"},"children":[]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">调用halPrimraryCpuMain或halSecondaryCpuMain</span></p>","expand":true,"richText":true,"isActive":false,"uid":"7616d468-f754-4491-9843-fee71e4d7dc2","associativeLineTargets":["439cc970-5781-4413-9028-f46563309356"],"associativeLineTargetControlOffsets":[[{"x":195.5,"y":0},{"x":-198.75,"y":12.73829087921115}]],"associativeLinePoint":[{"startPoint":{"x":1581,"y":1083.5},"endPoint":{"x":1866.5,"y":518.2617091207889,"dir":"left","range":-6.761709120788824}}],"associativeLineText":{"439cc970-5781-4413-9028-f46563309356":"调用"}},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">结束</span></p>","expand":true,"richText":true,"isActive":false,"uid":"03119a50-fe5a-43b1-8f56-22e4359b9161"},"children":[]}]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">复位结束</span></p>","expand":true,"richText":true,"isActive":false,"uid":"33cd5bc3-f473-4570-8c2f-961f09ed8cdb"},"children":[]}]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">结束</span></p>","uid":"105e23af-121c-4c07-b176-d2f0e6e07e7a","expand":true,"richText":true,"isActive":false},"children":[]}]},{"data":{"text":"<p><span style=\"font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">halPrimraryCpuMain</span></p>","expand":true,"richText":true,"isActive":false,"uid":"439cc970-5781-4413-9028-f46563309356","associativeLineTargets":[],"associativeLineTargetControlOffsets":[],"associativeLinePoint":[],"associativeLineText":{}},"children":[{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">开始</span></p>","uid":"83fdb10f-3288-4a40-a473-61571fcebacb","expand":true,"richText":true,"isActive":false},"children":[]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">设备树初级初始化，传递设备树基地址作为参数</span></p>","expand":true,"richText":true,"isActive":false,"uid":"5e767fc0-b579-4d96-83f4-421781d939a0"},"children":[{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">设备树有效性及合法性检查</span></p>","uid":"c6933e53-aee8-4c56-a966-28a0c799c57e","expand":true,"richText":true,"isActive":false},"children":[]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">__deviceTreeRootNodesScan扫描根节点信息</span></p>","expand":true,"richText":true,"isActive":false,"uid":"22e79002-2231-4391-b8b4-b77a09aa65d9"},"children":[{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">获取chosen节点，将bootargs存储在_G_ulKernelParam中</span></p>","uid":"3d2583af-d854-442f-a36c-cfa11112dd1b","expand":true,"richText":true,"isActive":false},"children":[]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">获取cells节点，存储在_G_iRootAddrCells和_G_iRootSizeCells中</span></p>","uid":"1955bc96-21f6-4289-afc4-c2794fe20da2","expand":true,"richText":true,"isActive":false,"generalization":null,"note":"cells有两个属性：address和size，分别表示设备树中address和size数据的表示\naddress-cells 被设置为1，表示每个地址由一个单独的32位整数表示\nsize-cells 也被设置为1，表示每个大小由一个单独的32位整数表示。"},"children":[]}]}]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">从设备树中获取内核启动参数</span></p>","expand":true,"richText":true,"isActive":false,"uid":"6d070deb-383c-46e9-9deb-4297b1d02858"},"children":[{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">将bootargs从_G_ulKernelParam中复制保存到pcStartParam</span></p>","uid":"d2fc323d-64ea-486a-8762-de0d3872ea2a","expand":true,"richText":true,"isActive":false},"children":[]}]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">API_KernelStartParam设置内核启动参数, 传递pcStartParam作为实参</span></p>","expand":true,"richText":true,"isActive":false,"uid":"d18d0b45-ac71-41cb-b911-abbded7381f6"},"children":[{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">赋值_K_ulNcpus</span></p>","expand":true,"richText":true,"isActive":false,"uid":"0c65f21a-addc-4fef-8b0b-fa1af9350f56"},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">赋值_K_pfuncKernelDebugLog</span></p>","expand":true,"richText":true,"isActive":false,"uid":"1fe502ae-b10b-45a8-a995-251216c872ab"},"children":[]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">赋值_K_pfuncKernelDebugError</span></p>","expand":true,"richText":true,"isActive":false,"uid":"4fc1573f-de22-4491-a972-0f16a428ac46"},"children":[]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">设置LW_KERN_FPU_EN_SET</span></p>","expand":true,"richText":true,"isActive":false,"uid":"d0c86dab-0e2f-41a4-8b7a-305b865de8ba"},"children":[]},{"data":{"text":"<p><span style=\"font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54); font-size: 14px;\">赋值_K_bHeapCrossBorderEn</span></p>","expand":true,"richText":true,"isActive":false,"uid":"f7492929-7592-4e64-995f-55d1e310e35a"},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">调用API_RootFsMapInit进行根文件系统映射初始化</span></p>","expand":true,"richText":true,"isActive":false,"uid":"303b456a-3f6a-4531-85fd-17bce31a3b8c","note":"主要是截取描述映射关系的字符串为下面两个数据结构赋值\nstatic LW_ROOTFS_MAP_NODE   _G_rfsmapRoot   = { \"/\" , \"/media/hdd1\" };\nstatic LW_ROOTFS_MAP_NODE   _G_rfsmapSubp[] = {\n    { \"/var\" , \"\" },\n    { \"/usr\" , \"\" },\n    { \"/tmp\" , \"\" },\n    { \"/sbin\", \"\" },\n    { \"/root\", \"\" },\n    { \"/qt\"  , \"\" },\n    { \"/lib\" , \"\" },\n    { \"/home\", \"\" },\n    { \"/etc\" , \"\" },\n    { \"/boot\", \"/media/hdd0\" },\n    { \"/bin\" , \"\" },\n    { \"/apps\", \"\" }\n};"},"children":[]}]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">启动内核，并传递参数</span></p>","expand":true,"richText":true,"isActive":false,"uid":"329e046c-cdcc-4e61-906d-627d38a49a94","note":"传递如下参数：\npvKernelHeapMem    内核堆内存首地址\nstKernelHeapSize   内核堆大小\npvSystemHeapMem    系统堆内存首地址\nstSystemHeapSize   系统堆大小"},"children":[{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">参数有效性检查</span></p>","uid":"5bc65882-c1e1-4a0f-8a76-2d3e2c4406b9","expand":true,"richText":true,"isActive":false},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">_KernelPrimaryLowLevelInit内核底层初始化</span></p>","uid":"0e15aae5-209f-4f90-a35f-5763b27757e1","expand":true,"richText":true,"isActive":false},"children":[{"data":{"text":"<p><span style=\"font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54); font-size: 14px;\">_GlobalPrimaryInit全局变量初始化</span></p>","uid":"d853ff7a-383a-4988-ac88-fd56e5db33e8","expand":true,"richText":true,"isActive":false},"children":[{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">设置系统状态_K_ucSysStatus为初始化状态INIT</span></p>","uid":"b033008f-4329-4b79-9eae-0eaa3a7f2255","expand":true,"richText":true,"isActive":false,"note":"系统状态分为以下两种：\n#define LW_SYS_STATUS_INIT          0\n#define LW_SYS_STATUS_RUNNING       1"},"children":[]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">初始化内核中关键性的自旋锁（简单的对自旋锁的数据成员赋初值）</span></p>","expand":true,"richText":true,"isActive":false,"uid":"0383720f-1309-4fd0-a9d2-8c7402d4a828","note":"初始化以下三类自旋锁：\n  &_K_klKernel.KERN_slLock);                             /*  初始化内核自旋锁            */\n &_K_slKernTime.SLCA_sl);                               /*  初始化内核时间自旋锁        */\n&_K_slcaAtomic.SLCA_sl);                               /*  初始化原子操作自旋锁        */\n  \n      \n初始化的操作如下：        \n\n    psl->SL_sltData.SLD_uiLock = 0;                                     /*  0: 未锁定状态  1: 锁定状态  */\n    psl->SL_pcpuOwner          = LW_NULL;\n    psl->SL_ulCounter          = 0;\n    psl->SL_pvReserved         = LW_NULL;\n    KN_SMP_WMB();    //内存操作同步，确保在它之前的内存访问操作都完成后，再执行它之后的内存访问操作。"},"children":[]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">分支主题</span></p>","expand":true,"richText":true,"isActive":false,"uid":"e56459a8-ce0a-4325-82fd-fa563d642325"},"children":[]}]},{"data":{"text":"<p><span style=\"font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(116, 147, 54);\">分支主题</span></p>","expand":true,"richText":true,"isActive":false,"uid":"9c0992c8-bcde-4c42-a02e-a7da35deceaf"},"children":[]}]}]},{"data":{"text":"<p><span style=\"color: rgb(116, 147, 54); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 14px;\">结束</span></p>","expand":true,"richText":true,"isActive":false,"uid":"fad79144-1537-4e53-b118-17239c946d31"},"children":[]}]}]},"theme":{"template":"avocado","config":{}},"view":{"transform":{"scaleX":1.2,"scaleY":1.2,"shear":0,"rotate":0,"translateX":-2392.474488171335,"translateY":-1117.6082104597879,"originX":0,"originY":0,"a":1.2,"b":0,"c":0,"d":1.2,"e":-2392.474488171335,"f":-1117.6082104597879},"state":{"scale":1.2,"x":-2392.474488171335,"y":-1117.6082104597879,"sx":-2052.474488171335,"sy":-915.6082104597879}}}