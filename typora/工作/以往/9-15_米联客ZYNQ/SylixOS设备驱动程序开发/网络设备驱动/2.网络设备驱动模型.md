[TOC]

# 网络设备驱动模型

## 网络设备驱动作用

控制设备将上层协议栈传递下来的数据包进行发送，并将设备收到的数据包传递给上层协议栈。

> 这里的上层协议栈指：链路层以上的——应用层，网络层，传输层。因为链路层和物理层集成在网卡中（网卡的MAC和PHY控制器）

## 网络设备驱动模型

SylixOS中网络设备驱动的体系从上到下分为四个层次，网络协议接口层、网络设备接口层、网络设备驱动层、网络设备与媒介，结构如下：



![image-20230920104905426](C:\Users\93413\Nutstore\1\我的坚果云\typora\typora-pic\image-20230920104905426.png)



1. 网络协议接口层向协议栈提供统一的数据包收发接口，这一层的存在使得上层协议栈独立于具体的设备；
2. 网络设备接口层为不同的网络设备控制器定义统一、抽象的结构体 netdev，该结构体是对网络设备控制器的抽象，以便驱动程序和网络协议栈可以与不同类型的网络设备控制器进行通信，而无需关心底层硬件的细节。
3. 网络设备驱动层对 netdev 结构体中的成员赋予具体的数值和函数，将来自操作系统的命令转化为对设备寄存器的操作，借此可真正使用网络设备；
4. 网络设备与媒介是网络相关的物理设备，例如 MAC 控制器、PHY、网口等等




## 补充概念

### MAC控制器，PHY，网口

MAC 控制器：是数据链路层中的一个子层。是网络设备或网络接口卡（如以太网网卡）上的硬件组件，负责实现数据链路层的功能，它将高层的网络数据包封装成适当的数据帧，并负责将这些数据帧发送到网络媒体或接收和解析接收到的数据帧。

PHY：物理层，负责将数字数据转换成物理信号以在网络媒体上传输，它负责管理电压、频率、时钟和数据编码等物理层细节。PHY 的功能与具体的媒体类型有关，例如以太网PHY用于连接以太网电缆或光纤，Wi-Fi PHY用于连接无线信道。

网口：实际发送数据的硬件



### 网络媒介

网络中用于传输数据的物理介质，它可以是不同类型的电缆、光纤、无线信号等。

如：电缆，网线，wifi信号等。

