[toc]



# IO设备介绍

IO设备主要有三个概念：设备控制器，设备本身和驱动程序

## 设备控制器

设备控制器是插在电路板上的一块芯片或一组芯片，这块电路板接收从操作系统传来的经驱动程序转换的命令，然后物理地控制设备。

例如：操作系统发出一个读取某个文件的数据的命令，驱动程序将其转化为从磁盘2读出11206号扇区，然后磁盘控制器接收该命令，并把这个线性扇区号转化为柱面，扇区和磁头。

这种转化极为复杂，磁盘控制器需要确定磁头臂应该在哪个柱面上，并对磁头臂发出指令，让其前后移动至所要求的柱面号，接着必须等待对应的扇区转动到磁头下面并开始读出数据，随着数据从驱动器读出，要消去引导块并计算校验和。最后还得把输入的二进制位组成字并存放在存储器中。

## 驱动程序

每类设备不同，对应的设备控制器不同，所以需要不同的软件进行控制。专门与控制器对话，发出命令并接收响应的软件，被称为设备驱动程序。

例如：操作系统发出一个读取某个`a.txt`文件的数据的命令，驱动程序将其转化为从磁盘2读出11206号扇区。

## 驱动程序与设备控制器对话的原理

每个设备控制器都有少量用于通信的寄存器。

例如：一个最小的磁盘控制器也会有用于指定磁盘地址，内存地址，扇区计数和方向（读或写）的寄存器。



设备驱动程序从操作系统获取一条命令，然后翻译成对应的值，并写进设备寄存器中，然后再给设备控制器一个执行操作的电信号，设备控制器就会根据自身寄存器中的值去对设备本身进行操作控制。